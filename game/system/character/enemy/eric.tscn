[gd_scene format=3 uid="uid://teuunrq7bxl5"]

[ext_resource type="PackedScene" uid="uid://cqk4twm4sfdyp" path="res://game/system/character/Character.tscn" id="1_66ayq"]
[ext_resource type="Script" uid="uid://dnppvxac4pdxj" path="res://game/system/character/enemy/enemy.gd" id="2_yvqvv"]
[ext_resource type="Texture2D" uid="uid://c3aws1pud8ee1" path="res://sprites/body_parts/FaceAssets/Enemies/Eric/EricHair.png" id="4_1dbei"]
[ext_resource type="Texture2D" uid="uid://dqpkhg3vo62qu" path="res://sprites/body_parts/Bodies/EricBody.png" id="4_yvqvv"]
[ext_resource type="Texture2D" uid="uid://cnwj52gow0ixr" path="res://sprites/body_parts/Basehead/EricBaseHead.png" id="5_yvqvv"]
[ext_resource type="Texture2D" uid="uid://n6uqe2633tnv" path="res://sprites/body_parts/EricNoise.png" id="6_cte70"]
[ext_resource type="PackedScene" uid="uid://c6ojue1kighsy" path="res://game/system/anatomy/parts/body/eric_arm.tscn" id="6_jemvd"]
[ext_resource type="Texture2D" uid="uid://ddhgc8fwjs6p" path="res://sprites/body_parts/FaceAssets/Enemies/Eric/EricEye1.png" id="7_16ne6"]
[ext_resource type="PackedScene" uid="uid://dpw0p64fe8sla" path="res://game/system/anatomy/parts/face/eye.tscn" id="8_cte70"]
[ext_resource type="Texture2D" uid="uid://bycmh4dp4kn8j" path="res://sprites/body_parts/FaceAssets/Enemies/Eric/EricEye2.png" id="8_y8j40"]
[ext_resource type="Texture2D" uid="uid://cf7r76jwh0wg3" path="res://sprites/body_parts/FaceAssets/Enemies/Boxer/BoxerEar1.png" id="9_1dbei"]
[ext_resource type="Texture2D" uid="uid://dfrroulxy08s3" path="res://sprites/body_parts/FaceAssets/Enemies/Eric/EricNose.png" id="9_y8j40"]
[ext_resource type="Texture2D" uid="uid://qv4luwgncgbb" path="res://sprites/body_parts/FaceAssets/Enemies/Eric/EricMouth.png" id="10_jemvd"]

[sub_resource type="Shader" id="Shader_2ro5p"]
code = "shader_type canvas_item;

uniform sampler2D sprite_texture : source_color, filter_linear;

uniform vec4 line_color : source_color = vec4(1.0, 1.0, 1.0, 1.0);
uniform float glowSize : hint_range(0.0, 300.0) = 15.0;
uniform int glowDensity : hint_range(0, 30) = 3;
uniform int glowRadialCoverage : hint_range(0, 32) = 4;
uniform float glowAngle : hint_range(0.0, 6.283) = 1.57;
uniform float glowSharpness : hint_range(0.0, 5.0) = 1.0;
uniform float alphaThreshold : hint_range(0.0, 1.0) = 0.2;

void fragment() {
	vec4 col = texture(sprite_texture, UV);

	COLOR = col;

	vec2 pixel_size = 1.0 / vec2(textureSize(sprite_texture, 0));
	float alph = 0.0;

	for (int i = 0; i < glowRadialCoverage; i++) {
		for (int j = 0; j < glowDensity; j++) {
			float angle = (TAU / float(glowRadialCoverage)) * float(i + 1) + glowAngle;
			float dist = glowSize * float(j + 1) / float(glowDensity);

			vec2 offset = vec2(sin(angle), cos(angle)) * pixel_size * dist;
			vec4 tex = texture(sprite_texture, UV + offset);

			float distFrom = float(glowDensity - j) / float(glowDensity);
			float sharpness = pow(distFrom, glowSharpness);

			alph += tex.a * line_color.a * sharpness;
		}
	}

	if (col.a < alphaThreshold) {
		COLOR.rgb = line_color.rgb;
		COLOR.a = alph;
	}
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_cte70"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("7_16ne6")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 5.0000002375
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 0.83200003952
shader_parameter/alphaThreshold = 0.2

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_1dbei"]
radius = 16.393717
height = 62.806717

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_dmudr"]
radius = 15.447592
height = 83.116486

[sub_resource type="ShaderMaterial" id="ShaderMaterial_dmudr"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("8_y8j40")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 5.0000002375
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 0.650000030875
shader_parameter/alphaThreshold = 0.2

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_cte70"]
radius = 18.76528
height = 60.637024

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_ex3ds"]
radius = 14.387146
height = 58.61557

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ex3ds"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("9_1dbei")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 1.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="ShaderMaterial" id="ShaderMaterial_2ov7o"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("9_1dbei")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 1.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="ShaderMaterial" id="ShaderMaterial_rsswb"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("9_y8j40")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 0.650000030875
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_1dbei"]
size = Vector2(33.84616, 72.30769)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_bb6qk"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("10_jemvd")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 1.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_cte70"]
size = Vector2(90.22403, 29.422552)

[node name="Eric" unique_id=1861387119 node_paths=PackedStringArray("arm") instance=ExtResource("1_66ayq")]
script = ExtResource("2_yvqvv")
critical_chance = 0.0
punch_strength = 0.02
attack_damage = 0.5
action_cooldown = 0.5
arm = NodePath("EricArm")
sfx_die = "event:/SFX/NPC/Eric/Die"
sfx_entry = "event:/SFX/NPC/Eric/Entry"
sfx_hurt = "event:/SFX/NPC/Eric/Hurt"

[node name="Shoulder" type="Sprite2D" parent="." index="0" unique_id=799220475]
z_index = -3
texture_filter = 1
position = Vector2(-1, 46)
rotation = -3.16503
scale = Vector2(0.55, 0.45)
texture = ExtResource("4_yvqvv")

[node name="Face" parent="." index="1" unique_id=1276534686]
position = Vector2(-11, 10)
scale = Vector2(0.65, 0.65)
texture = ExtResource("5_yvqvv")

[node name="Hair" type="Sprite2D" parent="Face" index="0" unique_id=1922594991]
z_index = 1
position = Vector2(-1.5384617, 4.615383)
scale = Vector2(1.0769231, 1.0769231)
texture = ExtResource("4_1dbei")

[node name="Noise" type="Sprite2D" parent="Face" index="1" unique_id=1677025307]
modulate = Color(1, 1, 1, 0.7372549)
texture_filter = 1
position = Vector2(-1.5384655, -1.5384598)
rotation = -0.06344986
texture = ExtResource("6_cte70")

[node name="EyeL" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="0" unique_id=1690948451]
position = Vector2(-46.153847, -38.46154)

[node name="Sprite" parent="Face/Features/EyeL" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_cte70")
texture = ExtResource("7_16ne6")

[node name="CollisionShape2D" parent="Face/Features/EyeL/MouseDetectArea" parent_id_path=PackedInt32Array(1690948451, 1106976729) index="0" unique_id=149295176]
position = Vector2(30.769234, 3.076926)
rotation = -0.7606134
shape = SubResource("CapsuleShape2D_1dbei")

[node name="EyeL2" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="1" unique_id=2128479719 instance=ExtResource("8_cte70")]
unique_name_in_owner = true
position = Vector2(46.15384, -78.46155)
rotation = -3.8661535

[node name="Sprite" parent="Face/Features/EyeL2" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_cte70")
scale = Vector2(1.3, 1.3)
texture = ExtResource("7_16ne6")

[node name="CollisionShape2D" parent="Face/Features/EyeL2/MouseDetectArea" parent_id_path=PackedInt32Array(2128479719, 1106976729) index="0" unique_id=149295176]
position = Vector2(28.496529, 2.6236908)
rotation = -0.90372
shape = SubResource("CapsuleShape2D_dmudr")

[node name="EyeR" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="2" unique_id=584210078]
position = Vector2(56.923077, -23.076923)

[node name="Sprite" parent="Face/Features/EyeR" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_dmudr")
texture = ExtResource("8_y8j40")
flip_h = false

[node name="CollisionShape2D" parent="Face/Features/EyeR/MouseDetectArea" parent_id_path=PackedInt32Array(584210078, 1106976729) index="0" unique_id=149295176]
position = Vector2(10.767133, 4.6202765)
rotation = 0.99918497
shape = SubResource("CapsuleShape2D_cte70")

[node name="EyeR2" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="3" unique_id=872170903 instance=ExtResource("8_cte70")]
unique_name_in_owner = true
position = Vector2(-21.538464, -7.6923084)
rotation = 0.7299963

[node name="Sprite" parent="Face/Features/EyeR2" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_dmudr")
position = Vector2(-53.009533, 20.975922)
texture = ExtResource("8_y8j40")

[node name="CollisionShape2D" parent="Face/Features/EyeR2/MouseDetectArea" parent_id_path=PackedInt32Array(872170903, 1106976729) index="0" unique_id=149295176]
position = Vector2(10.767133, 4.6202765)
rotation = 0.99918497
shape = SubResource("CapsuleShape2D_ex3ds")

[node name="EarL" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="4" unique_id=1222327045]
visible = false
max_hp = 2.0

[node name="Sprite" parent="Face/Features/EarL" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_ex3ds")

[node name="EarR" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="5" unique_id=959483894]
visible = false
max_hp = 2.0

[node name="Sprite" parent="Face/Features/EarR" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_2ov7o")

[node name="Nose" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="6" unique_id=1350482542]
position = Vector2(-3.0769234, -3.0769234)

[node name="Sprite" parent="Face/Features/Nose" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_rsswb")
position = Vector2(-4.615385, -0.15384676)
texture = ExtResource("9_y8j40")

[node name="CollisionShape2D" parent="Face/Features/Nose/MouseDetectArea" parent_id_path=PackedInt32Array(1350482542, 1106976729) index="0" unique_id=149295176]
position = Vector2(30.769241, 8.46154)
shape = SubResource("RectangleShape2D_1dbei")

[node name="Mouth" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="7" unique_id=508432269]
position = Vector2(15.384615, 53.846157)

[node name="Sprite" parent="Face/Features/Mouth" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_bb6qk")
position = Vector2(-18, -51)
texture = ExtResource("10_jemvd")

[node name="CollisionShape2D" parent="Face/Features/Mouth/MouseDetectArea" parent_id_path=PackedInt32Array(508432269, 1106976729) index="0" unique_id=149295176]
position = Vector2(-25.942389, -3.0551605)
rotation = 0.65627617
shape = SubResource("RectangleShape2D_cte70")

[node name="CollisionShape2D2" type="CollisionShape2D" parent="Face/Features/Mouth/MouseDetectArea" parent_id_path=PackedInt32Array(508432269, 1106976729) index="1" unique_id=287658633]
position = Vector2(36.845604, -1.6361542)
rotation = -0.67051935
shape = SubResource("RectangleShape2D_cte70")

[node name="MarginContainer" parent="CombatComponent/CanvasLayer" parent_id_path=PackedInt32Array(823960288, 296824878) index="0" unique_id=1187610258]
anchors_preset = 0
anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
offset_left = 0.0
offset_top = 0.0
offset_right = 146.0
offset_bottom = 199.0
grow_horizontal = 1
grow_vertical = 1
theme_override_constants/margin_left = 230
theme_override_constants/margin_top = 100

[node name="EricArm" parent="." index="3" unique_id=1972221418 instance=ExtResource("6_jemvd")]
position = Vector2(-89, 47)

[editable path="Face/Features/EyeL"]
[editable path="Face/Features/EyeL2"]
[editable path="Face/Features/EyeR"]
[editable path="Face/Features/EyeR2"]
[editable path="Face/Features/EarL"]
[editable path="Face/Features/EarR"]
[editable path="Face/Features/Nose"]
[editable path="Face/Features/Mouth"]
[editable path="CombatComponent"]
