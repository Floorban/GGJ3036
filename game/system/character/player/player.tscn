[gd_scene format=3 uid="uid://dvu82xeeb87ff"]

[ext_resource type="PackedScene" uid="uid://cqk4twm4sfdyp" path="res://game/system/character/Character.tscn" id="1_obar5"]
[ext_resource type="Script" uid="uid://cmbivobrytkx7" path="res://game/system/character/player/player.gd" id="2_b2mth"]
[ext_resource type="PackedScene" uid="uid://cc5iuju00imms" path="res://game/system/anatomy/parts/body/player_arm.tscn" id="3_3ipx8"]
[ext_resource type="Texture2D" uid="uid://0e11br4awprf" path="res://sprites/body_parts/Basehead/BaseHead.png" id="3_jme82"]
[ext_resource type="Texture2D" uid="uid://c7hpvptgk40bi" path="res://sprites/body_parts/Noise.png" id="5_0fnm0"]
[ext_resource type="Texture2D" uid="uid://btk5wola3ox5u" path="res://sprites/body_parts/Shadows/Shadows.png" id="5_alke5"]
[ext_resource type="Texture2D" uid="uid://dq5dyeefodkfo" path="res://sprites/body_parts/FaceAssets/Beard.png" id="6_w1s3x"]
[ext_resource type="Texture2D" uid="uid://cv1u60umjpb1l" path="res://sprites/body_parts/FaceAssets/Beard2.png" id="7_388rn"]
[ext_resource type="Texture2D" uid="uid://w4hkk7bw5m48" path="res://sprites/body_parts/FaceAssets/Nose.png" id="7_ka5xu"]
[ext_resource type="Texture2D" uid="uid://b8hrd4p7oqxrv" path="res://sprites/body_parts/FaceAssets/Beard4.png" id="8_eq501"]
[ext_resource type="PackedScene" uid="uid://cu05fkjh25k63" path="res://game/system/character/player/fix_area.tscn" id="9_hu301"]
[ext_resource type="Texture2D" uid="uid://b25lvb5weclia" path="res://sprites/body_parts/Blood/Blood6.png" id="10_ltwwj"]
[ext_resource type="Texture2D" uid="uid://bm7o5t6rm32a8" path="res://sprites/body_parts/FaceAssets/Eye2.2.png" id="10_xvqmr"]
[ext_resource type="Texture2D" uid="uid://d1r4bn32e30v7" path="res://sprites/body_parts/FaceAssets/MouthPainExp.png" id="11_f2h07"]
[ext_resource type="Texture2D" uid="uid://c31jfa2u83jap" path="res://sprites/body_parts/Blood/Blood5.png" id="11_ltwwj"]
[ext_resource type="Texture2D" uid="uid://dwaux5shinmc3" path="res://sprites/body_parts/FaceAssets/eye4.png" id="11_wqm0g"]
[ext_resource type="Texture2D" uid="uid://dfhosu07qdc7s" path="res://sprites/body_parts/Blood/Blood4.png" id="12_0eq7q"]
[ext_resource type="Texture2D" uid="uid://defn8lxlh0cq7" path="res://sprites/body_parts/Bodies/MCbody.png" id="12_f2h07"]
[ext_resource type="Texture2D" uid="uid://egk8mk2xn73u" path="res://sprites/ui/Blood.png" id="13_innbf"]
[ext_resource type="Texture2D" uid="uid://c2nhffovbgged" path="res://sprites/ui/BloodForSurgeryListItems.png" id="15_8ga5m"]
[ext_resource type="Texture2D" uid="uid://civr2jgjofjyt" path="res://sprites/body_parts/FaceAssets/MCfacevariations/ears/Ear.png" id="17_innbf"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_hu301"]
radius = 14.021568
height = 44.037544

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_wqm0g"]
radius = 15.033022
height = 44.04039

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_xvqmr"]
radius = 17.719166
height = 74.43643

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_ltwwj"]
radius = 20.99828
height = 74.01004

[sub_resource type="RectangleShape2D" id="RectangleShape2D_xvqmr"]
size = Vector2(30, 72)

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_0eq7q"]
radius = 15.971291
height = 82.33055

[sub_resource type="Shader" id="Shader_2ro5p"]
code = "shader_type canvas_item;

uniform sampler2D sprite_texture : source_color, filter_linear;

uniform vec4 line_color : source_color = vec4(1.0, 1.0, 1.0, 1.0);
uniform float glowSize : hint_range(0.0, 300.0) = 15.0;
uniform int glowDensity : hint_range(0, 30) = 3;
uniform int glowRadialCoverage : hint_range(0, 32) = 4;
uniform float glowAngle : hint_range(0.0, 6.283) = 1.57;
uniform float glowSharpness : hint_range(0.0, 5.0) = 1.0;
uniform float alphaThreshold : hint_range(0.0, 1.0) = 0.2;

void fragment() {
	vec4 col = texture(sprite_texture, UV);

	COLOR = col;

	vec2 pixel_size = 1.0 / vec2(textureSize(sprite_texture, 0));
	float alph = 0.0;

	for (int i = 0; i < glowRadialCoverage; i++) {
		for (int j = 0; j < glowDensity; j++) {
			float angle = (TAU / float(glowRadialCoverage)) * float(i + 1) + glowAngle;
			float dist = glowSize * float(j + 1) / float(glowDensity);

			vec2 offset = vec2(sin(angle), cos(angle)) * pixel_size * dist;
			vec4 tex = texture(sprite_texture, UV + offset);

			float distFrom = float(glowDensity - j) / float(glowDensity);
			float sharpness = pow(distFrom, glowSharpness);

			alph += tex.a * line_color.a * sharpness;
		}
	}

	if (col.a < alphaThreshold) {
		COLOR.rgb = line_color.rgb;
		COLOR.a = alph;
	}
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_eq501"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("10_xvqmr")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 5.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_8xspq"]
size = Vector2(30.499966, 19.50006)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_hu301"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("11_wqm0g")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 5.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_f2h07"]
size = Vector2(34.164482, 18.00142)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_wqm0g"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("17_innbf")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 5.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hu301"]
size = Vector2(33.87018, 66.16188)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xvqmr"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("17_innbf")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 5.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wqm0g"]
size = Vector2(33.957714, 70.170364)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ltwwj"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("7_ka5xu")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 3.62800017233
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_388rn"]
size = Vector2(23, 66)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_0eq7q"]
shader = SubResource("Shader_2ro5p")
shader_parameter/sprite_texture = ExtResource("11_f2h07")
shader_parameter/line_color = Color(1, 1, 1, 1)
shader_parameter/glowSize = 4.00000019
shader_parameter/glowDensity = 30
shader_parameter/glowRadialCoverage = 32
shader_parameter/glowAngle = 1.57
shader_parameter/glowSharpness = 5.0
shader_parameter/alphaThreshold = 0.2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_eq501"]
size = Vector2(70, 26)

[node name="Player" unique_id=1861387119 node_paths=PackedStringArray("arm") groups=["player"] instance=ExtResource("1_obar5")]
script = ExtResource("2_b2mth")
critical_chance = 0.3
top_down_dir = -1
arm = NodePath("ArmR")

[node name="Face" parent="." index="0" unique_id=1276534686]
self_modulate = Color(0.84745413, 0.6991107, 0.7562015, 1)
rotation = 3.1415927
texture = ExtResource("3_jme82")

[node name="Noise" type="Sprite2D" parent="Face" index="0" unique_id=290120544]
modulate = Color(1, 1, 1, 0.7372549)
texture_filter = 1
position = Vector2(-2.0000002, -2.9999998)
rotation = -0.053846277
texture = ExtResource("5_0fnm0")

[node name="Shadow" type="Sprite2D" parent="Face" index="1" unique_id=1034765696]
texture_filter = 1
position = Vector2(3.999999, -12.000001)
rotation = 0.087266445
scale = Vector2(1.1, 1.1)
texture = ExtResource("5_alke5")

[node name="Beard1" type="Sprite2D" parent="Face" index="2" unique_id=1900917381]
position = Vector2(-3.9999993, 8)
texture = ExtResource("6_w1s3x")

[node name="Beard2" type="Sprite2D" parent="Face" index="3" unique_id=396302187]
visible = false
position = Vector2(1.0000017, 20)
texture = ExtResource("7_388rn")

[node name="Beard3" type="Sprite2D" parent="Face" index="4" unique_id=1251884929]
visible = false
position = Vector2(-0.99999833, 19)
texture = ExtResource("8_eq501")

[node name="FixAreas" type="Node2D" parent="Face" index="5" unique_id=273804179]

[node name="FixAreaEyeL" parent="Face/FixAreas" index="0" unique_id=1630340479 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(28.999998, -20.000002)
my_anatomy = NodePath("../../Features/EyeL")

[node name="Sprite" parent="Face/FixAreas/FixAreaEyeL" index="0" unique_id=1542207743]
position = Vector2(1.000001, -1.9999981)
rotation = -2.7547193
scale = Vector2(0.07, 0.07)
texture = ExtResource("10_ltwwj")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaEyeL" index="1" unique_id=32785027]
position = Vector2(8.754478e-08, 1.1920929e-07)
rotation = -1.5443118
shape = SubResource("CapsuleShape2D_hu301")

[node name="FixAreaEyeR" parent="Face/FixAreas" index="1" unique_id=1521391253 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(-31.000002, -19.999998)
my_anatomy = NodePath("../../Features/EyeR")

[node name="Sprite" parent="Face/FixAreas/FixAreaEyeR" index="0" unique_id=1542207743]
position = Vector2(1.9999995, -2.000001)
rotation = -1.3151702
scale = Vector2(0.08, 0.08)
texture = ExtResource("11_ltwwj")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaEyeR" index="1" unique_id=32785027]
position = Vector2(0.9999991, 7.1525574e-07)
rotation = -1.5102458
shape = SubResource("CapsuleShape2D_wqm0g")

[node name="FixAreaEarL" parent="Face/FixAreas" index="2" unique_id=127680847 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(62.999996, -10.000006)
rotation = -0.17453292
anatomy_type = 1
my_anatomy = NodePath("../../Features/EarL")

[node name="Sprite" parent="Face/FixAreas/FixAreaEarL" index="0" unique_id=1542207743]
position = Vector2(-6.1408243, 13.201904)
rotation = 0.9391054
scale = Vector2(0.08593076, 0.12566878)
texture = ExtResource("12_0eq7q")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaEarL" index="1" unique_id=32785027]
position = Vector2(-3.301715, 1.4486718)
rotation = 0.43315792
shape = SubResource("CapsuleShape2D_xvqmr")

[node name="FixAreaEarR" parent="Face/FixAreas" index="3" unique_id=865976243 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(-65.99999, 1.0000056)
rotation = -0.05235988
anatomy_type = 1
my_anatomy = NodePath("../../Features/EarR")

[node name="Sprite" parent="Face/FixAreas/FixAreaEarR" index="0" unique_id=1542207743]
position = Vector2(17.081364, -1.107549)
rotation = -0.42811036
scale = Vector2(0.24624492, 0.39563715)
texture = ExtResource("13_innbf")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaEarR" index="1" unique_id=32785027]
position = Vector2(2.9958706, 0.15700674)
rotation = -0.08895778
shape = SubResource("CapsuleShape2D_ltwwj")

[node name="FixAreaNose" parent="Face/FixAreas" index="4" unique_id=1860991290 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(0.99999934, -8)
anatomy_type = 2
my_anatomy = NodePath("../../Features/Nose")

[node name="Sprite" parent="Face/FixAreas/FixAreaNose" index="0" unique_id=1542207743]
position = Vector2(1.9999996, -4.0000005)
rotation = -1.586368
scale = Vector2(0.15, 0.072)
texture = ExtResource("10_ltwwj")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaNose" index="1" unique_id=32785027]
position = Vector2(-1.0000001, -1)
shape = SubResource("RectangleShape2D_xvqmr")

[node name="FixAreaMouth" parent="Face/FixAreas" index="5" unique_id=1677497174 node_paths=PackedStringArray("my_anatomy") instance=ExtResource("9_hu301")]
position = Vector2(-0.9999968, 37)
anatomy_type = 3
my_anatomy = NodePath("../../Features/Mouth")

[node name="Sprite" parent="Face/FixAreas/FixAreaMouth" index="0" unique_id=1542207743]
position = Vector2(5.952586e-09, 0)
rotation = 0.025145605
scale = Vector2(0.06, 0.035)
texture = ExtResource("15_8ga5m")

[node name="CollisionShape2D" parent="Face/FixAreas/FixAreaMouth" index="1" unique_id=32785027]
position = Vector2(-0.9999995, 5)
rotation = -1.5948731
shape = SubResource("CapsuleShape2D_0eq7q")
debug_color = Color(0.828425, 0.3136256, 0.62059414, 0.41960785)

[node name="EyeL" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="0" unique_id=1690948451]
position = Vector2(28.999998, -20.000002)
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 4.0

[node name="Sprite" parent="Face/Features/EyeL" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_eq501")
position = Vector2(2.861023e-06, -1.9073486e-06)
texture = ExtResource("10_xvqmr")

[node name="MouseDetectArea" parent="Face/Features/EyeL" index="1" unique_id=1106976729]
position = Vector2(2.861023e-06, -1.9073486e-06)

[node name="CollisionShape2D" parent="Face/Features/EyeL/MouseDetectArea" index="0" unique_id=149295176]
position = Vector2(1.5, -2.000002)
shape = SubResource("RectangleShape2D_8xspq")

[node name="EyeR" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="1" unique_id=584210078]
position = Vector2(-31.000002, -19.999998)
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 4.0

[node name="Sprite" parent="Face/Features/EyeR" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_hu301")
position = Vector2(4.7683716e-07, 2.3841858e-07)
scale = Vector2(1.1, 1.1)
texture = ExtResource("11_wqm0g")

[node name="MouseDetectArea" parent="Face/Features/EyeR" index="1" unique_id=1106976729]
position = Vector2(-8.002902, -0.5239539)

[node name="CollisionShape2D" parent="Face/Features/EyeR/MouseDetectArea" index="0" unique_id=149295176]
position = Vector2(7.005912, 0.44643235)
rotation = 0.07903791
scale = Vector2(1.0000004, 1.0000004)
shape = SubResource("RectangleShape2D_f2h07")

[node name="EarL" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="2" unique_id=1222327045]
position = Vector2(62.999996, -10.000006)
rotation = -0.09759025
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 4.0

[node name="Sprite" parent="Face/Features/EarL" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_wqm0g")
position = Vector2(-4.7683716e-06, 9.536743e-07)
texture = ExtResource("17_innbf")
flip_h = false

[node name="MouseDetectArea" parent="Face/Features/EarL" index="1" unique_id=1106976729]
position = Vector2(8.108372, 33.664528)

[node name="CollisionShape2D" parent="Face/Features/EarL/MouseDetectArea" index="0" unique_id=149295176]
position = Vector2(-8.108373, -33.664524)
rotation = 0.11014061
scale = Vector2(1.0000002, 1.0000002)
shape = SubResource("RectangleShape2D_hu301")

[node name="EarR" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="3" unique_id=959483894]
position = Vector2(-65.99999, 1.0000056)
rotation = -0.052493285
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 4.0

[node name="Sprite" parent="Face/Features/EarR" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_xvqmr")
position = Vector2(0, 0)
texture = ExtResource("17_innbf")
flip_h = true

[node name="MouseDetectArea" parent="Face/Features/EarR" index="1" unique_id=1106976729]
position = Vector2(2.0879803, 1.9079723)

[node name="CollisionShape2D" parent="Face/Features/EarR/MouseDetectArea" index="0" unique_id=149295176]
position = Vector2(-1.1566467, -2.8493485)
rotation = -0.14349334
scale = Vector2(0.99999994, 0.99999994)
shape = SubResource("RectangleShape2D_wqm0g")

[node name="Nose" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="4" unique_id=1350482542]
position = Vector2(0.99999934, -8)
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 4.0

[node name="Sprite" parent="Face/Features/Nose" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_ltwwj")
scale = Vector2(1.2, 1.2)
texture = ExtResource("7_ka5xu")

[node name="CollisionShape2D" parent="Face/Features/Nose/MouseDetectArea" parent_id_path=PackedInt32Array(1350482542, 1106976729) index="0" unique_id=149295176]
position = Vector2(-0.5000001, 1)
shape = SubResource("RectangleShape2D_388rn")

[node name="Mouth" parent="Face/Features" parent_id_path=PackedInt32Array(2130456873) index="5" unique_id=508432269]
position = Vector2(-0.9999968, 37)
stat_modifiers = {
0: 0.0,
1: 0.0,
2: 0.1,
3: 0.1,
4: 0.0,
5: 0.0
}
max_hp = 6.0

[node name="Sprite" parent="Face/Features/Mouth" index="0" unique_id=500964707]
material = SubResource("ShaderMaterial_0eq7q")
position = Vector2(-1.000001, 3)
scale = Vector2(1.3, 1.3)
texture = ExtResource("11_f2h07")

[node name="CollisionShape2D" parent="Face/Features/Mouth/MouseDetectArea" parent_id_path=PackedInt32Array(508432269, 1106976729) index="0" unique_id=149295176]
position = Vector2(-1.0000001, 4)
shape = SubResource("RectangleShape2D_eq501")

[node name="Shoulder" type="Sprite2D" parent="." index="1" unique_id=779808539]
z_index = -3
texture_filter = 1
rotation = -3.054326
scale = Vector2(0.5, 0.5)
texture = ExtResource("12_f2h07")

[node name="ArmR" parent="." index="2" unique_id=334395171 instance=ExtResource("3_3ipx8")]
unique_name_in_owner = true
z_index = 2
position = Vector2(103, -23)

[node name="MarginContainer" parent="CombatComponent/CanvasLayer" parent_id_path=PackedInt32Array(823960288, 296824878) index="0" unique_id=1187610258]
theme_override_constants/margin_right = 230

[editable path="Face/FixAreas/FixAreaEyeL"]
[editable path="Face/FixAreas/FixAreaEyeR"]
[editable path="Face/FixAreas/FixAreaEarL"]
[editable path="Face/FixAreas/FixAreaEarR"]
[editable path="Face/FixAreas/FixAreaNose"]
[editable path="Face/FixAreas/FixAreaMouth"]
[editable path="Face/Features/EyeL"]
[editable path="Face/Features/EyeR"]
[editable path="Face/Features/EarL"]
[editable path="Face/Features/EarR"]
[editable path="Face/Features/Nose"]
[editable path="Face/Features/Mouth"]
[editable path="CombatComponent"]
